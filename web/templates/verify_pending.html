{% extends "base.html" %}

{% block title %}Verify Your Email - Respondent Pro{% endblock %}

{% block extra_css %}
<style>
    body {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
</style>
{% endblock %}

{% block body %}
<div class="min-h-screen p-3 bg-gradient-to-br from-accent-purple to-purple-600 flex items-center justify-center">
    <div class="max-w-md w-full bg-base-100 rounded-2xl p-10 shadow-xl">
        <div class="w-20 h-20 mx-auto mb-6 bg-gradient-to-br from-accent-purple to-purple-600 rounded-full flex items-center justify-center text-white text-4xl">✉️</div>
        <h1 class="text-2xl font-semibold text-base-content text-center mb-3">Verify Your Email</h1>
        <p class="text-base-content/70 text-center mb-6 leading-relaxed">
            We've sent a verification email to:
        </p>
        <div class="bg-base-200 p-3 rounded-lg text-center font-semibold text-base-content mb-6">{{ email }}</div>
        
        {% if error %}
        <div class="alert alert-error mb-4">{{ error }}</div>
        {% endif %}
        
        <div id="successMessage" class="alert alert-success mb-4 hidden"></div>
        
        <button id="resendButton" class="btn btn-primary w-full bg-gradient-to-r from-accent-purple to-purple-600 border-none" onclick="resendVerificationEmail()">
            Resend Verification Email
        </button>
        
        <div class="bg-base-200 p-4 rounded-lg mt-6 text-sm text-base-content/70">
            <strong>Instructions:</strong>
            <ol class="list-decimal list-inside mt-3 space-y-2">
                <li>Check your email inbox (and spam folder)</li>
                <li>Click the verification link in the email</li>
                <li>You'll be automatically redirected to your dashboard</li>
            </ol>
            <p class="mt-3 text-xs">
                The verification link expires in 7 days.
            </p>
        </div>
    </div>
</div>

<script>
async function resendVerificationEmail() {
    const button = document.getElementById('resendButton');
    const successMessage = document.getElementById('successMessage');
    
    button.disabled = true;
    button.textContent = 'Sending...';
    
    try {
        const response = await fetch('/api/verify-email/send', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            }
        });
        
        const data = await response.json();
        
        if (response.ok) {
            successMessage.textContent = 'Verification email sent! Please check your inbox.';
            successMessage.style.display = 'block';
            setTimeout(() => {
                successMessage.style.display = 'none';
            }, 5000);
        } else {
            alert('Error: ' + (data.error || 'Failed to send email'));
        }
    } catch (error) {
        alert('Error: ' + error.message);
    } finally {
        button.disabled = false;
        button.textContent = 'Resend Verification Email';
    }
}
</script>
{% endblock %}
